#!/bin/sh
. "$(dirname "$0")/_/husky.sh"


echo '
ğŸ—ï¸ ğŸ‘· ğŸ‘·â€â™€ï¸ QA Walking your code now
---------------------------------
'

if ! git diff --no-ext-diff --quiet --exit-code; then
  echo 'You have unstaged changes do you wish to proceed? This is going to check all of your files not just staged changes'
  select yn in "Yes" "No"; do
    case $yn in
      Yes ) git add .; break;;
      No ) break;;
    esac
  done < /dev/tty
fi


# Check Prettier standards
npm run check-format ||
(
echo '
ğŸ¤¢ğŸ¤®ğŸ¤¢ğŸ¤® Your styling looks disgusting. ğŸ¤¢ğŸ¤®ğŸ¤¢ğŸ¤®
Prettier Check Failed. Run npm run format, add changes and try commit again.
';

false;
)


# Check ESLint Standards
npm run lint ||
(
echo '
ğŸ˜¤ğŸ€ğŸ‘‹ğŸ˜¤ Do you want to be a remediation pro?ğŸ˜¤ğŸ€ğŸ‘‹ğŸ˜¤ 
ESLint Check Failed. Make the required changes listed above, add changes and try to commit again.
'

false; 
)


# Check tsconfig standards
npm run check-types ||
(
echo '
ğŸ¤¡ğŸ˜‚âŒğŸ¤¡ Failed Type check. ğŸ¤¡ğŸ˜‚âŒğŸ¤¡
Are you seriously trying to write that? Make the changes required above.
'

false;
)


# If everything passes... Now we can commit
echo '
ğŸ¤”ğŸ¤”ğŸ¤”ğŸ¤”... Alright Alright Alright... Code looks good to me... Trying to build now. ğŸ¤”ğŸ¤”ğŸ¤”ğŸ¤”
'

npm run build ||
(
echo '
âŒğŸ‘·ğŸ”¨âŒ Better call Bob... Because your build failed âŒğŸ‘·ğŸ”¨âŒ
Next build failed: View the errors above to see why. 
'

false;
)


# If everything passes... Now we can commit
echo '
âœ…âœ…âœ…âœ… You win this time... I am committing this now. âœ…âœ…âœ…âœ…'